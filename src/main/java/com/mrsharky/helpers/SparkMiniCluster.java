/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.mrsharky.helpers;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.util.ArrayList;
import java.util.List;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FSDataOutputStream;
import org.apache.hadoop.fs.FileStatus;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.LocalFileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.hdfs.HdfsConfiguration;
import org.apache.hadoop.hdfs.MiniDFSCluster;
import org.apache.hadoop.test.PathUtils;

/**
 *
 * @author mrsharky
 */
public class SparkMiniCluster {
    private static final String CLUSTER_1 = "cluster1";


    private File testDataPath;
    private Configuration conf;
    private MiniDFSCluster cluster;
    private FileSystem fs;

    public void setUp() throws Exception {

        testDataPath = new File(PathUtils.getTestDir(getClass()),"miniclusters");
        System.clearProperty(MiniDFSCluster.PROP_TEST_BUILD_DATA);
        conf = new HdfsConfiguration();
        File testDataCluster1 = new File(testDataPath, CLUSTER_1);
        String c1Path = testDataCluster1.getAbsolutePath();
        conf.set(MiniDFSCluster.HDFS_MINIDFS_BASEDIR, c1Path);
        conf.set("mapred.child.java.opts", "-Xmx5120M");
        conf.set("dfs.datanode.max.xcievers", "20000");
        conf.set("dfs.datanode.max.transfer.threads", "20000");
        conf.set("dfs.datanode.socket.write.timeout", "120000");
        conf.set("dfs.socket.timeout", "120000");
        conf.set("hadoop.job.history.user.location", "none");

        //conf.set("io.compression.codecs", "com.hadoop.compression.lzo.LzoCodec, com.hadoop.compression.lzo.LzopCodec");
        //conf.set("io.compression.codec.lzo.class", "com.hadoop.compression.lzo.LzoCodec");

        cluster = new MiniDFSCluster.Builder(conf).build();
        fs = FileSystem.get(conf);
    }

    public void tearDown() throws Exception {
        Path dataDir = new Path(testDataPath.getParentFile().getParentFile().getParent());
        fs.delete(dataDir, true);
        File rootTestFile = new File(testDataPath.getParentFile().getParentFile().getParent());
        String rootTestDir = rootTestFile.getAbsolutePath();
        Path rootTestPath = new Path(rootTestDir);
        LocalFileSystem localFileSystem = FileSystem.getLocal(conf);
        localFileSystem.delete(rootTestPath, true);
        cluster.shutdown();
    }

   


    public void testClusterWithData() throws Throwable {
        String IN_DIR = "testing/resolve/input";
        String OUT_DIR = "testing/resolve/output";
        String DATA_FILE = "sample.txt";

        Path inDir = new Path(IN_DIR);
        Path outDir = new Path(OUT_DIR);

        fs.delete(inDir, true);
        fs.delete(outDir,true);

        // create the input data files
        List<String> content = new ArrayList<String>();
        content.add("2016-09-27 17:59:59.996|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|4867|2|233|DEVICE|IF6100S_018|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.996|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|13028|2|303|DEVICE|IF6100S_024|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|5040|2|193|DEVICE|IF6100S_048|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|10589|2|270|DEVICE|IF6100S_072|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|4719|2|335|DEVICE|IF6100S_096|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|13623|2|327|DEVICE|IF6100S_120|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|4094|2|351|DEVICE|IF6100S_144|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|12695|2|362|DEVICE|IF6100S_168|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6100S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6100S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.997|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|6405|2|223|DEVICE|IF6301S|1|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S_Exists|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S_Exists|1|ip-172-31-43-142|0|0|9d56db6a-91cc-49a7-86d9-5934967bd6a0|9d56db6a-91cc-49a7-86d9-5934967bd6a0|1|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|341038|2|299|DEVICE|IF6301S_002|1|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|9d56db6a-91cc-49a7-86d9-5934967bd6a0|9d56db6a-91cc-49a7-86d9-5934967bd6a0|1|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|9606|2|305|DEVICE|IF6301S_004|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|17530|2|323|DEVICE|IF6301S_006|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|7025|2|313|DEVICE|IF6301S_008|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|16852|2|283|DEVICE|IF6301S_012|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|7213|2|330|DEVICE|IF6301S_018|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|17726|2|271|DEVICE|IF6301S_024|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|5742|2|340|DEVICE|IF6301S_048|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|17388|2|250|DEVICE|IF6301S_072|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.998|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|6847|2|275|DEVICE|IF6301S_096|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.999|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|15032|2|337|DEVICE|IF6301S_120|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.999|EVAL-TEST-RULES|1643685100642515|2016-04-01 07:02:50.000|7035|2|286|DEVICE|IF6301S_144|0|{\"cOldAcctDate\":\"971395200000\",\"AccountID\":\"c8217b359c886b3caf45ae1efeb8550a262e3c74bf3b232952936248401c41d4\",\"Email\":\"9101a6e7dfeb44cde50e8e6033bd24cc21e3595cdaefc024308b023829844bbb\",\"logIdUpd\":\"1313625600000\",\"cType\":\"I\",\"ip\":\"67.180.237.49\",\"PostalCode\":\"c75efc70c77e54d82e4390723d4d56c38d4238d80420f0d579d06c807debaa60\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1384300800000\",\"IP4\":\"67.180.237.49\",\"cNewAcctDate\":\"1453766400000\",\"UC\":\"7247952c06283833ff80c6d90c1ec295d9ecd9275da8eb37d705bb7ac34fd2fd\",\"cInfoUp\":\"1453850936523\",\"UserID\":\"01b6f544001d91b0538622efc50084637dc1f19022cb0f049bfaecb6612f14e9\",\"cLastCon\":\"1063065600000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1445126400000\",\"SessionID\":\"b9f588dcc53be2f327b3504330e7aa5387886ea32c1f4e0a7c2533b01495ef09\",\"IF_6100S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_6201_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IT\":\"false\",\"W_2316\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"IDFV\":\"6E021219-ACF4-4386-BEFA-8F9E20CBC1C1\",\"I_5302_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P_Exists\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_IGC\":\"false\",\"U_640S\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"I_6201\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"U_640P\":\"4FC17219AF1C1F40656AD545A82D1459CEC40688\",\"U_640S_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"W_2316_Exists\":\"6FD5AB339082EF45883972B14BD606F69C7F9C88\",\"WAF2\":\"442ADE0D-C6DA-4506-8701-BFEB7A3FE171 1412992330265\",\"U_640_Exists\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"IF_6301S\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"IF_6100S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"4A639139A3F256F5C44B12128D73548F4AF11709\",\"I_5302\":\"9A0632FB86F605A4B4128B74756FBC29C4C9070E\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E233\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"6670EC70-1959-4BAA-AC4F-03FF3877F9EA 1459007346087\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|DIISOLATED|IF_6301S|4A639139A3F256F5C44B12128D73548F4AF11709~IF_6301S|1|ip-172-31-43-142|0|0|||0|1|T12345\n");
        content.add("2016-09-27 17:59:59.999|EVAL-TEST-RULES|1643685100642623|2016-04-01 07:19:18.000|1840|2|189|DEVICE|UC|0|{\"cOldAcctDate\":\"446947200000\",\"AccountID\":\"b31083a296523f2c27d9284ad846be7b1d809b7b4734d38935fbd3c6fc63243b\",\"Email\":\"677f072a2b0403ab907698360554152f69a603619f015379eb0a71e65604d793\",\"logIdUpd\":\"1270857600000\",\"cType\":\"I\",\"ip\":\"72.184.228.181\",\"PostalCode\":\"b5a0a573ba3936d6e7ba3ec782b7c1e97a359b63199a6d04597ff8095b7e18ae\",\"cAssoc\":\"F\",\"cPlat\":\"F\",\"cAddrUp\":\"1194307200000\",\"IP4\":\"72.184.228.181\",\"cNewAcctDate\":\"1428969600000\",\"UC\":\"82e4e96eab68842bb8e658522f669610f2fb48319d2dc4fe69d644caf816e215\",\"cLobDesc\":\"C\",\"cInfoUp\":\"1446476155549\",\"UserID\":\"6fdda58a08b05595de3aa641e6bfbf1d8ba81d9c4634cf24bbfa6da2bb901b7f\",\"cLastCon\":\"1194307200000\",\"ConfirmedFraud\":\"0\",\"logPswUp\":\"1407283200000\",\"SessionID\":\"f6c1cf7b4d62bc1fb98847af7f19c11824697e7bc2df62604f6c0832aa9681b8\",\"IF_6100S\":\"BF04D00F45F4640C272D31601A3201347FB82AB1\",\"I_6201_Exists\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"DI_IT\":\"false\",\"W_2316\":\"AFDEC7D6A161E4F688FD428A6006D6C72475C9A2\",\"IDFV\":\"3D474F55-5CB7-4A2B-BE92-BC5AA4555CC8\",\"I_5302_Exists\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"U_640P_Exists\":\"D01B0489F28E09A9F29A5FE588D38F461DC2F5AA\",\"U_640\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"DI_IGC\":\"false\",\"U_640S\":\"AFDEC7D6A161E4F688FD428A6006D6C72475C9A2\",\"I_6201\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"U_640P\":\"D01B0489F28E09A9F29A5FE588D38F461DC2F5AA\",\"U_640S_Exists\":\"AFDEC7D6A161E4F688FD428A6006D6C72475C9A2\",\"W_2316_Exists\":\"AFDEC7D6A161E4F688FD428A6006D6C72475C9A2\",\"WAF2\":\"FBF5960F-DA28-4F9D-A690-825FF480A924 1393467657827\",\"U_640_Exists\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"IF_6301S\":\"BF04D00F45F4640C272D31601A3201347FB82AB1\",\"IF_6100S_Exists\":\"BF04D00F45F4640C272D31601A3201347FB82AB1\",\"DI_WM\":\"iphone\",\"IF_6301S_Exists\":\"BF04D00F45F4640C272D31601A3201347FB82AB1\",\"I_5302\":\"6E25B92E1E888E1514144147F1863F7CDC3D12D3\",\"DI_ID\":\"false\",\"NavUA\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13D15\",\"SHA_WIFI\":\"2f5672cb76691b989bbd2022a5349939a2d7b952\",\"WAF\":\"96DB69E4-BE52-437A-843F-B61E58316C87 1459308422727\",\"DI_IM\":\"true\",\"MM_CT\":\"CABLE_DSL\"}|SESSIONCOOKIE|UC|82e4e96eab68842bb8e658522f669610f2fb48319d2dc4fe69d644caf816e215~UC|0|ip-172-31-43-142|0|1|||1|1|T12345\n");

        writeHDFSContent(fs, inDir, DATA_FILE, content);    
        //writeLzoCompressedHDFSContent(fs, inDir, DATA_FILE, content);


        if (true) {
            // ResolveShrinkEvalRuleTest hadoopJob = new ResolveShrinkEvalRuleTest(conf,
            // IN_DIR, OUT_DIR, "NONE");
            // assertTrue(hadoopJob.job.isSuccessful());

            // now check that the output is as expected
            printJobResults(fs, outDir);
        }

        // clean up after test case
        fs.delete(inDir, true);
        fs.delete(outDir,true);
    }  

    private void writeHDFSContent(FileSystem fs, Path dir, String fileName, List<String> content) throws IOException {
        Path newFilePath = new Path(dir, fileName);
        FSDataOutputStream out = fs.create(newFilePath);
        for (String line : content){
            out.writeBytes(line);
        }

        out.close();
    }

    protected void printJobResults(FileSystem fs, Path outDir) throws Exception {
        Path currPath = new Path(outDir.toString());
        FileStatus[] fileStatus = fs.listStatus(currPath);
        int maxRowsToDisplay = 10;
        int totalFilesFound = 0;
        for (FileStatus file : fileStatus) {
            String name = file.getPath().getName();
            String fullPath = file.getPath().toString();
            FileStatus[] allVariables = fs.listStatus(file.getPath());
            for (FileStatus currVar : allVariables) {
                Path filePath = currVar.getPath();
                System.out.println("File: " + currVar.getPath().toString());
                BufferedReader reader = new BufferedReader(new InputStreamReader(fs.open(filePath)));
                int rowCount = 0;
                while (reader.ready()) {
                    String line = reader.readLine();
                    if (line == null){
                        //fail("Results are not what was expected");
                    }

                    System.out.println(line);
                    rowCount++;
                    if (rowCount >= maxRowsToDisplay) {
                        break;
                    }
                }

                //assertNull(reader.readLine());
                reader.close();totalFilesFound++;
            }
        }
        System.out.println("############# Total files: " + totalFilesFound);
    }
}
